\documentclass[9pt]{beamer}

\usetheme{Rochester}
%\setbeamercolor{fg:red}
\usecolortheme{default}
%\useoutertheme{smoothtree}
\setbeamercolor{structure}{bg=black, fg=blue}

\definecolor{bblue}{rgb}{1,0,0.3}
\definecolor{dblue}{rgb}{0.7,0,0.1}
\definecolor{red}{rgb}{0.7,0,0.2}
\definecolor{green}{rgb}{0.4,0.75,0.4}
\definecolor{blue}{rgb}{0.2,0.3,0.93}


\usepackage[brazilian]{babel}
\usepackage[latin1]{inputenc}
\usepackage{amsmath,amssymb,amsfonts,latexsym,amstext,amscd}
\usepackage{graphicx}
\usepackage{enumerate}
\usepackage{multicol}
\usepackage{tikz}
%\usepackage{eqnarray}
\usepackage{setspace}
\usepackage{dsfont}
%\usepackage[dvips]{graphicx}
\usepackage{enumerate}
\usepackage{array}
\usepackage{amsthm}
\usepackage{subfigure}
\usepackage{multirow}
%\usepackage{psfrag}
%\usepackage{color}
%\usepackage{lipsum}
%\usepackage{fancyhdr}
%\usepackage{bmpsize}
%\usepackage{mathrsfs}
\usepackage{hyperref}
\newtheorem{teo}{Teorema}
\newtheorem{propr}{Propriedade}
\newtheorem{lema}{Lema}
\newtheorem{coro}{Corolário}
\newtheorem{propo}{Proposição}
\newtheorem{defi}{Definição}
\newtheorem{exem}{Exemplo}
\newtheorem{prin}{Princípio}


%%%%%%%%%%%%%%%%%%% Dados %%%%%%%%%%%%%%%%%%%%%%%%%

\title{Algoritmo de Wang-Mendel para aprendizagem de regras fuzzy}

\author{Renato Lopes Moura}

\date{16 de dezembro de 2016}

\begin{document}
%\onehalfspacing
%%%%%%%%%%%%%%%%%%%%%%%%%%% Slide 1 - Capa %%%%%%%%%%%%%%%%%%%%

\frame{\maketitle
}

%%%%%%%%%%%%%%%%%%%%%%%%%%% Slide 2 - Sumário %%%%%%%%%%%%%%%%%%%%
\small
\frame{
\frametitle{Sumário}
\tableofcontents}

%% ----------------------------------------------------------------------------

\section{Visão Geral}

\frame{
\frametitle{Visão Geral}
Esta apresentação descreve o método geral proposto por Li-Xin Wang e Jerry Mendel \cite{wangmendel} para geração de uma base de regras fuzzy a partir de dados numéricos.

\hspace{3cm}

O método consiste de 5 passos, que serão detalhados a seguir. E após, serão apresentados alguns exemplos de aplicação em problemas diversos.

\hspace{3cm}

Para facilitar o entendimento do método vamos considerar um caso simples com \textbf{2 variáveis de entrada} e \textbf{1 variável de saída}, que poderá ser facilmente estendido para casos mais gerais ao final.
}

%% ----------------------------------------------------------------------------

\section{Passo 1: Divisão dos espaços de entradas e saídas}

\frame{
\frametitle{Passo 1: Divisão dos espaços de entradas e saídas}
Inicialmente, é necessário dividir os intervalos de valores possíveis das variáveis de entrada e saída em regiões fuzzy.
\newline
Supondo que os domínios das variáveis de entrada e saída sejam respectivamente:
\begin{center}
$[x_1^{-},x_1^{+}], [x_2^{-},x_2^{+}], [y^{-},y^{+}]$
\end{center}
Podemos criar as seguintes regiões fuzzy utilizando funções de pertinência triangulares:
%figura das regiões fuzzy%
%comentar que é importante ter a soma das pertinências para um dado ponto igual a 1 para obter uma boa performance do algoritmo
}

%% ----------------------------------------------------------------------------

\section{Passo 2: Geração de regras fuzzy a partir dos dados}
\frame{
\frametitle{Passo 2: Geração de regras fuzzy a partir dos dados}
Em seguida, para cada par \textbf{entradas}-\textbf{saída} são determinados os graus de pertinência e é gerada uma regra. Por exemplo considerando o seguinte par:
\begin{center}
$(x_1^{(n)},x_2^{(n)};y^{(n)})$
\end{center}
%figura com as pertinências da entrada indicadas
Podemos gerar a seguinte regra:
\begin{center}
$(x_1^{(n)},x_2^{(n)};y^{(n)}) \Rightarrow [(x_1^{(n)}(0.8\text{ em }B1),x_2^{(n)}(0.7\text{ em }S1);y^{(n)}(0.9\text{ em }CE)] \Rightarrow \text{Regra n}$ \\
\textbf{SE} $x_1$ é $B1$ e $x_2$ é $S1$, \textbf{ENTÃO} $y$ é $CE$
\end{center}
}

%% ----------------------------------------------------------------------------

\section{Passo 3: Associando um grau a cada regra}

\frame{
\frametitle{Passo 3: Associando um grau a cada regra}
Após o passo anterior devemos ter uma grande quantidade de regras (1 para cada par entradas-saída), e inclusive regras conflitantes entre si (antecedentes iguais mas consequentes diferentes).
\newline
Para resolver tais conflitos, é associado um "grau de confiabilidade" a cada regra dado por:
\begin{center}
$D(\text{Regra n})= m_{B1}(x_1^{(n)}).m_{S1}(x_2^{(n)}).m_{CE}(y^{(n)})$
\end{center}
E então nos casos de conflito são descartadas as regras com menor "grau de confiabilidade".

\hspace{3cm}

Nesta etapa também é possível agregar o conhecimento de um especialista e/ou controlar a influência de dados que possam conter erros de medição. Isto é feito acrescentando-se um novo parâmetro $m^{(n)}$ à equação anterior:
\begin{center}
$D(\text{Regra n})= m_{B1}(x_1^{(n)}).m_{S1}(x_2^{(n)}).m_{CE}(y^{(n)}).m^{(n)}$
\end{center}
}

%% ----------------------------------------------------------------------------

\section{Passo 4: Criação de uma Base de Regras}
\frame{
\frametitle{Passo 4: Criação de uma Base de Regras} 
No caso simples do nosso exemplo são possíveis 35 regras distintas conforme a tabela a seguir:
\begin{table}[]
\centering
\begin{tabular}{lllllllll}
\multicolumn{1}{c}{} &                         & \multicolumn{7}{c}{x2}                                                                                                                                                \\
\multicolumn{1}{c}{} &                         & S3                    & S2                    & S1                    & CE                    & B1                    & B2                    & B3                    \\ \cline{3-9} 
\multirow{5}{*}{x1}  & \multicolumn{1}{l|}{S2} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} \\ \cline{3-9} 
                     & \multicolumn{1}{l|}{S1} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} \\ \cline{3-9} 
                     & \multicolumn{1}{l|}{CE} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} \\ \cline{3-9} 
                     & \multicolumn{1}{l|}{B1} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} \\ \cline{3-9} 
                     & \multicolumn{1}{l|}{B2} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} & \multicolumn{1}{l|}{} \\ \cline{3-9} 
\end{tabular}
\caption{Base de regras}
\label{base_de_regras}
\end{table}
}

\frame{
\frametitle{Passo 4: Criação de uma Base de Regras} 
Idealmente, cada entrada da tabela anterior deve ter um valor associado que foi obtido no passo 3. Porém, podem existir combinações de antecedentes que não foram cobertas pelo conjunto de treinamento.

\hspace{3cm}

Nestes casos, podem ser criadas regras linguísticas com o apoio de um especialista para completar a base de regras.
\newline
Este artifício também pode ser utilizado para substituir regras que apresentem um baixo "grau de confiabilidade".

}

%% ----------------------------------------------------------------------------

\section{Passo 5: Inferência e Defuzzificação}
\frame{
\frametitle{Passo 5: Inferência e Defuzzificação}
Por fim, com as devidas adaptações, podemos utilizar diferentes métodos de inferência e de defuzzificação dos resultados para tratar dados novos.

\hspace{3cm}

Os métodos de inferência e defuzzificação mais utilizados são Mamdani e Centróide, respectivamente.
}

%% ----------------------------------------------------------------------------

\section{Aplicação 1: Backer-Upper Truck}
\frame{
\frametitle{Aplicação 1: Back-Upper Truck}
Trata-se de um problema clássico da literatura que consiste em estacionar um caminhão de ré em uma doca.
\newline
As variáveis de entrada são:
\begin{itemize}
\item $x$ - posição do caminhão no eixo horizontal
\item $\phi$ - ângulo do caminhão em relação ao eixo horizontal
\end{itemize}
E a variável de saída é:
\begin{itemize}
\item $\theta$ - ângulo das rodas dianteiras em relação ao eixo do caminhão
\end{itemize}

%figura do caminhão
}

\frame{
\frametitle{Aplicação 1: Back-Upper Truck}
Para a obtenção do conjunto de dados de treinamento foram utilizados 14 estados iniciais (posição e ângulo) e as seguintes equações cinemáticas aproximadas:
\begin{center}
$x(t+1) = x(t) + \cos[\phi(t)+\theta(t)]+\sin[\theta(t)]\sin[\phi(t)]$
\end{center}
\begin{center}
$\phi(t+1) = \phi(t) - \sin^{-1}[\frac{2\sin(\theta(t))}{b}]$
\end{center}
onde $b$ é o tamanho do caminhão, no nosso caso $b = 4$.

\hspace{3cm}

Os estados iniciais e dados de treinamento podem ser vistos em \cite{wangmendel2}
}

\frame{
\frametitle{Aplicação 1: Back-Upper Truck}
Os conjuntos fuzzy definidos para as variáveis de entrada e saída estão representados nas figuras a seguir:

%figuras das pertinencias
}

\frame{
\frametitle{Aplicação 1: Back-Upper Truck}
E a base de regras obtida a partir dos dados numéricos foi a seguinte:

%figura da base de regras
}
%% ----------------------------------------------------------------------------

\section{Aplicação 2: Série temporal de Mackey-Glass}
\frame{
\frametitle{Aplicação 2: Série temporal de Mackey-Glass}

}

%% ----------------------------------------------------------------------------

\section{Aplicação 3: Como ficar milionário?}
\frame{
\frametitle{Aplicação 3: Como ficar milionário?}

}

%%%%%%%%%%%%%%%%%%%%%%%%%%% Slide 33- Referências %%%%%%%%%%%%%%%%%%%%
\section{Referências}
\frame{
\frametitle{Referências}

\scriptsize
\begin{thebibliography}{72}

\bibitem{wangmendel} L.  Wang  and  J.  M.  Mendel,  {\it Generating  fuzzy  rules  by  learning  from examples} IEEE Trans. Syst., Man, Cybern., vol. 22, no. 6, pp. 1414-1427, (1992).

\bibitem{wangmendel2} L. Wang and J. M. Mendel, {\it Generating fuzzy rules from numerical data, with applications}, USC SIPI Rep. No. 169, Univ. Southern Calif., Los Angeles, (1991).

\end{thebibliography}
} 

\end{document}